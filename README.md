# Fishboost R scripts and functions

`add_h2_to_pars.R`
- `add_h2_to_pars(x, pars)`
    - Adds heritability and phenotypes to a posterior chain `x` and return updated list of parameters `pars`.

`apply_fixed_effects.R`
- `apply_fixed_effects(popn, params)`
    - Apply trial, donor, and weight FEs to `popn`.

`apply_links.R`

`apply_setup.R`

`basic_km.R`

`batch.R`
- This script is for running on Eddie, and should be called with two arguments, a dataset (e.g. "fb-test") and a row number (e.g. 1) to select which set to take.

`batch_flatten_bici_states.R`
- This function takes the BICI output and converts it into a format suitable for R.

`batch_run_bici_sim.R`

`batch_selection_on_R0.R`

`build_grm_from_snps.R`

`calc_LPs.R`

`calc_bayes_factor.R`

`calc_fixed_effects.R`

`censor_data.R`

`cleanup_files.R`

`combine_replicates.R`

`compare_Hs.R`

`crop.R`

`discretise_time_bici.R`

`etc_to_km.R`

`examine_parasites.R`

`export_trace.R`

`fb_Tsyms.R`

`fb_variants.R`

`fes_to_vals.R`

`find_all_libraries_used.R`

`fit_periods.R`

`fix_H_links.R`

`fix_fb_data.R`

`fix_traitnames.R`

`flatten_bici_states.R`

`generate_bici_script.R`

`generate_km_data_bici.R`

`generate_km_data_sire.R`

`generate_pedigree_file.R`

`generate_sire_xml.R`
`get_R0.R`

`get_Tinfs.R`

`get_ds_times.R`

`get_fb_map.R`

`get_mult.R`

`get_ranks.R`

`get_roc.R`

`get_subgroup_vals.R`

`get_tmax.R`

`ggroups_fns.R`

`gwas.R`

`import_Hinv_christina.R`

`import_Hinv_ricardo_vr1.R`

`import_Hinv_ricardo_vr2.R`

`import_Hinv_rpw.R`

`import_fishboost_data.R`

`inc_seed.R`

`init_populations.R`

`libraries.R`

`libs.R`

`make_fb_dictionary.R`

`make_grm.R`

`make_grm_from_snps.R`

`make_matrices.R`

`make_parameters.R`

`make_params.R`

`make_pedigree.R`

`make_plots.R`

`make_time_series.R`

`make_traits_from_grm.R`

`make_traits_from_pedigree.R`

`make_traits_from_pedigree.R.R`

`make_traits_from_pedigree2.R`

`masoud_sir.R`

`objectives.R`

`patch_in_traits.R`

`patch_params.R`

`pipeline.R`

`post_selection_on_R0.R`

`pred_accs.R`

`profiling.R`

`read_examples.R`

`rebuild_posteriors.R`

`remove_bici_fes.R`

`rename_bici_pars.R`

`rename_pars.R`

`reorder_protocol.R`

`replace_all_RData_files.R`

`rep_fb.R`

`roc_curves.R`

`run_bici_sim.R`

`scan_ess_gr.R`

`sense_spec.R`

`sensitivity_analysis.R`

`set_cors.R`

`set_ge_opts.R`

`set_groups.R`

`set_traits.R`

`set_use_flags.R`

`set_weights.R`

`shape_to_XP.R`

`sigma_factor.R`

`simulate_epidemic.R`

`source_files.R`

`split_fb_traits.R`

`states_to_etc.R`

`stoch_SEIR.R`

`subgroups_to_parameters.R`

`test_args.R`

`test_ribbon.R`

`thresholds.R`

`tidy_up_periods.R`

`tmp_fix_green_lines.R`

`tmp_fix_prior_patches.R`

`update_sim_new_data.R`

`update_times.R`

`utils.R`

`widen_priors.R`

